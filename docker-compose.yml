version: '2.2'

services:      
  ng-pokedex-build:
    build:
      context: .
      dockerfile: ./.docker/build.dockerfile
    command: ng serve --host 0.0.0.0
    container_name: ng-pokedex-build-start
    image: ng-pokedex-build
    networks:
      - dev-network
    ports:
      - '4200:4200'
      
  ng-pokedex-test:
    build:
      context: .
      dockerfile: ./.docker/tests.dockerfile
    command: /bin/bash
    container_name: ng-pokedex-test-start
    image: ng-pokedex-test

  ng-pokedex-lint:
    command: ng lint
    container_name: ng-pokedex-lint-start
    image: ng-pokedex-test
      
  ng-pokedex-unittest:
    command: ng test
    container_name: ng-pokedex-unittest-start
    image: ng-pokedex-test

  ng-pokedex-e2etest:
    command: ng e2e
    container_name: ng-pokedex-e2etest-start
    image: ng-pokedex-test 

  ng-pokedex-prod:
    build:
      context: .
      dockerfile: ./.docker/prod.dockerfile
    command: /bin/bash /pokedex/create_artifact.sh
    container_name: ng-pokedex-prod-start
    image: ng-pokedex-prod
    networks:
      - dev-network
    ports:
      - '4200:4200'
    volumes:
      - /artifacts:/artifacts

#  ng-pokedex-base:
#    build:
#      context: .
#      dockerfile: ./.docker/base.dockerfile
#    command: /bin/bash
#    container_name: ng-pokedex-base-start
#    image: ng-pokedex-base
#    volumes:
#      - .:/pokedex
      
networks:
  dev-network:
    driver: bridge
